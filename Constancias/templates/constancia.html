{% extends 'index.html' %}

{% comment %} Generación de la constancia a partir de una solicitud aprobada  {% endcomment %}

{% block titulo %} Constancia {% endblock %}

{% block scriptcss %}
	<link rel="stylesheet" href="/static/css/Constancia.css">
{% endblock scriptcss %}

{% block contenido %}
<strong>Constancia {{ InformacionConstancia.0.FolioConstancia }}</strong>
<form class="form-horizontal " id="formulario_constancia" method="post" action="" accept-charset="utf-8">
{% csrf_token %}
	<input type='hidden' name='varIdConstancia' id="varIdConstancia" value='{{ InformacionConstancia.0.IdConstancia }}' />
	<input type='hidden' name='varIdSolicitud' id="varIdSolicitud" value='{{ InformacionSolicitud.IdSolicitud }}' />
	<input type='hidden' name='varFolioSolicitud' id="varFolioSolicitud" value='{{ InformacionSolicitud.FolioSolicitud }}' />
	<legend></legend>
	<div class="row">
		<div class="span4">
			<div class="control-group">			
				<label class="control-label">Solicitud</label> 			<!-- Text input Folio solicitud -->
				<div class="controls">
					<input type="text" class="input-small" value="{{ InformacionSolicitud.FolioSolicitud }}" disabled />
				</div> 															<!-- Fin Folio solicitud -->
			</div>			
		</div>	
		<div class="span4">
			<div class="control-group">			
				<label class="control-label">Fecha de Emisión</label> 			<!-- Text input Fecha de Emisión Constancia -->
				<div class="controls">
				{% if not InformacionConstancia %}
					<input type="text" class="input-small" id="FechaEmision" name="FechaEmision" readonly />
				{% else %}
					<input type="text" class="input-small" value='{{ InformacionConstancia.0.FechaEmision|date:"d/m/Y" }}' disabled />
				{% endif %} 					
				</div> 															<!-- Fin Fecha de Emisión Constancia -->
			</div>			
		</div>
		<div class="span3">
			<table>
				<thead>
					<tr>
						<th colspan="2">Vigencia</th>
					</tr>
					<tr>
						<th>Desde</th>
						<th>Hasta</th>
					</tr>
				</thead>
				<tbody>
					<tr>
						<td><input type="text" class="input-small" id="VigenciaInicio" name="VigenciaInicio" value='{{ VigenciaInicio|date:"d/m/Y" }}' readonly /></td>
						<td><input type="text" class="input-small" id="VigenciaFinal" name="VigenciaFinal" value='{{ VigenciaFinal }}' readonly /></td>
					</tr>
				</tbody>
			</table>
		</div>	
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       <!-- Text input Contrato de Reaseguro --> 
				<label class="control-label">Contrato de Reaseguro</label>
				<div class="controls">
					<input class="input-medium" type="text" value="{{ NumeroContrato }}" disabled>
				</div>
			</div>												  <!-- Fin Text input Contrato de Reaseguro --> 
		</div>
	</div>
	<div class="alert alert-success">
		<h4>Datos del Asegurado</h4>
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       <!-- Text input Nombre --> 
				<label class="control-label">Asegurado</label>
				<div class="controls">
					<input class="input-xlarge" type="text" value="{{ Asegurado.0.NombrePersona }}" disabled>
				</div>
			</div>												  <!-- Fin Text input Nombre --> 
		</div>
		<div class="span5">
			<div class="control-group">						      <!-- Text input Rfc --> 
				<label class="control-label">RFC</label>
				<div class="controls">
					<input type="text" class="input-medium" value="{{ Asegurado.0.RfcPersona }}" disabled>
				</div>
			</div>												  <!-- Fin Text input Rfc --> 	
		</div>		
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       				<!-- Text input Domicilio --> 
				<label class="control-label">Domicilio</label>
				<div class="controls">
					<input type="text" class="input-xlarge" value="{{ Asegurado.0.DireccionPersona }}" disabled>
				</div>
			</div>												  				<!-- Fin Text input Domicilio --> 
		</div>	
		<div class="span5">
			<div class="control-group">						       				<!-- Text input CP --> 
				<label class="control-label">C.P.</label>
				<div class="controls">
					<input type="text" class="input-small" value="{{ Asegurado.0.CPPersona }}" disabled>
				</div>
			</div>												  				<!-- Fin Text input CP --> 
		</div>			
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       				<!-- Text input Municipio --> 
				<label class="control-label">Municipio</label>
				<div class="controls">
					<input type="text" class="input-medium" value="{{ Asegurado.0.MunicipioPersona }}" disabled>
				</div>
			</div>												  				<!-- Fin Text input Municipio --> 
		</div>	
		<div class="span5">
			<div class="control-group">						       				<!-- Text input Estado --> 
				<label class="control-label">Estado</label>
				<div class="controls">
					<input type="text" class="input-medium" value="{{ Asegurado.0.EstadoPersona }}" disabled>
				</div>
			</div>												  				<!-- Fin Text input Estado --> 
		</div>			
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						      				<!-- Text input Telefono --> 
				<label class="control-label">Teléfono</label>
				<div class="controls">
					<input type="text" class="input-medium" value="{{ Asegurado.0.TelefonoPersona }}" disabled>
				</div>
			</div>												  				<!-- Fin Text input Telefono --> 	
		</div>	
	</div>
	<div class="alert alert-success">
		<h4>Datos del Contratante</h4>
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       <!-- Text input Nombre --> 
				<label class="control-label">Contratante</label>
				<div class="controls">
					<input class="input-xlarge" type="text" disabled value="{{ Contratante.0.NombrePersona }}">
				</div>
			</div>												  <!-- Fin Text input Nombre --> 			
		</div>
		<div class="span5">
			<div class="control-group">						      <!-- Text input Rfc --> 
				<label class="control-label">RFC</label>
				<div class="controls">
					<input type="text" class="input-medium" disabled value="{{ Contratante.0.RfcPersona }}">
				</div>
			</div>												  <!-- Fin Text input Rfc --> 				
		</div>
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       				<!-- Text input Domicilio --> 
				<label class="control-label">Domicilio</label>
				<div class="controls">
					<input type="text" class="input-xlarge" disabled value="{{ Contratante.0.DireccionPersona }}">
				</div>
			</div>												  				<!-- Fin Text input Domicilio --> 
		</div>	
		<div class="span5">
			<div class="control-group">						       				<!-- Text input CP --> 
				<label class="control-label">C.P.</label>
				<div class="controls">
					<input type="text" class="input-small" disabled value="{{ Contratante.0.CPPersona }}">
				</div>
			</div>												  				<!-- Fin Text input CP --> 
		</div>			
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       				<!-- Text input Municipio --> 
				<label class="control-label">Municipio</label>
				<div class="controls">
					<input type="text" class="input-medium" disabled value="{{ Contratante.0.MunicipioPersona }}">
				</div>
			</div>												  				<!-- Fin Text input Municipio --> 
		</div>	
		<div class="span5">
			<div class="control-group">						       				<!-- Text input Estado --> 
				<label class="control-label">Estado</label>
				<div class="controls">
					<input type="text" class="input-medium" disabled value="{{ Contratante.0.EstadoPersona }}">
				</div>
			</div>												  				<!-- Fin Text input Estado --> 
		</div>			
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						      				<!-- Text input Telefono --> 
				<label class="control-label">Teléfono</label>
				<div class="controls">
					<input type="text" class="input-medium" disabled value="{{ Contratante.0.TelefonoPersona }}">
				</div>
			</div>												  				<!-- Fin Text input Telefono --> 	
		</div>	
	</div>
	<div class="alert alert-success">
		<h4>Ubicación</h4>
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       				<!-- Text input Latitud --> 
				<label class="control-label">Ubicación Latitud</label>
				<div class="controls">
					<input class="input-medium" id="UbicacionBienLat" name="UbicacionBienLat" type="text" disabled value="{{ InformacionRelacionAnexaActaVerificacion.UbicacionBienLat }}">
				</div>
			</div>												  				<!-- Fin Text input Latitud --> 
		</div>
		<div class="span5">
			<div class="control-group">						       				<!-- Text input Longitud --> 
				<label class="control-label">Ubicación Longitud</label>
				<div class="controls">
					<input class="input-medium" id="UbicacionBienLng" name="UbicacionBienLng" disabled type="text" value="{{ InformacionRelacionAnexaActaVerificacion.UbicacionBienLng }}">
				</div>
			</div>												  				<!-- Fin Text input Longitud --> 
		</div>
	</div>
	<div class="row">
		<div class="span6">
			<div class="control-group">						       				<!-- Text input CP --> 
				<label class="control-label">C.P.:</label>
				<div class="controls">
					<input class="input-small" id="CP" name="CP" type="text" value="{{ InformacionRelacionAnexaActaVerificacion.CP }}" disabled>
				</div>
			</div>												  				<!-- Fin Text input CP --> 
		</div>
	</div>
	
	<div class="alert alert-success">
		<h4>Beneficiarios</h4>
	</div>
	<table class="table table-striped tblPersonaBeneficiarioConstancia">														<!-- Tabla que muestra los beneficiarios -->
		<thead>
			<tr>
				<th style="display:none;">IdBeneficiario</th>
				<th>Nombre Beneficiario</th>
				<th>Domicilio</th>
				<th>Rfc</th>
				<th>Porcentaje</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			{% for beneficiario in Beneficiarios %}
				<tr>
					<td style="display:none;">{{ beneficiario.IdBeneficiario }}</td>
					<td>{{ beneficiario.NombrePersonaBeneficiario }}</td>
					<td>{{ beneficiario.DomicilioPersonaBeneficiario }}</td>
					<td>{{ beneficiario.RfcPersonaBeneficiario }}</td>
					{% if beneficiario.Porcentaje %}
					<td>{{ beneficiario.Porcentaje }} %</td>
					{% else %}
					<td><input type="number" class="input-mini" min="1" max="100" name="porcentajeBeneficiario[]" /></td>
					{% endif %}
				</tr>
			{% endfor %}
		</tbody>
	</table>
	<div class="alert alert-success">
		<h4>Descripción Detallada de los Bienes</h4>
	</div>
	<input type='hidden' name='SumaAseguradaTotal' id="SumaAseguradaTotal" value='' />
    <input type='hidden' name='CuotaNeta' id="CuotaNeta" value='' />		
	<table class="table table-striped">
		<thead>
			<th style="display:none;">idEquipo</th>
			<th>Nombre</th>
			<th>Marca</th>
			<th>Modelo</th>
			<th>No. Serie</th>
			<th>Documentación</th>
			<th>Fecha</th>
			<th style="text-align:center;">Cantidad</th>
			<th style="text-align:center;">Valor Unitario</th>
			<th style="text-align:center;">Suma Asegurada</th>
		</thead>
		<tfoot>
			<tr>
				<th colspan="8" style="text-align:right;">Suma Asegurada:</th>
				<th style="text-align:right;"><input type="text" id="SumaAseguradaBienes" readonly value="{{ SumaAseguradaBienes }}" style="text-align:right;"></th>
			</tr>
		</tfoot>
		<tbody>
			{% if DescripcionBienes %}
				{% for descripcionBien in DescripcionBienes %}
					<tr>
					<td style="display:none;">{{ descripcionBien.IdBien }}</td>
					<td>{{ descripcionBien.NombreEquipo }}</td>
					<td>{{ descripcionBien.Marca }}</td>
					<td>{{ descripcionBien.Modelo }}</td>
					<td>{{ descripcionBien.Serie }}</td>
					<td>{{ descripcionBien.DocumentacionEvaluacion }}</td>
					<td>{{ descripcionBien.FechaBien|date:"d/m/Y" }}</td>
					<td style="text-align:right;">{{ descripcionBien.Cantidad }}</td>
					<td style="text-align:right;">{{ descripcionBien.ValorUnitario }}</td>
					<td style="text-align:right;">{{ descripcionBien.SumaAsegurada }}</td>
					</tr>
				{% endfor %}					
			{% endif %}
		</tbody>
	</table>
	<div class="alert alert-success">
		<h4>Coberturas</h4>
	</div>
	<table class="table-striped">
		<thead>
			<tr>
				<th colspan="2">Participación</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td><b>Fondo: </b>{{ Cotizador.PorcentajeFondo }}%</td>
				<td><b>Reaseguro: </b>{{ Cotizador.PorcentajeReaseguro }}%</td>
			</tr>
		</tbody>
	</table>
	<table class="table table-striped tblCoberturas">
		<thead>
			<tr>
				<th style="display:none;">IdCobertura</th>
				<th>Cobertura</th>
				<th>Tarifa</th>
				<th style="text-align:center;">Tarifa Fondo</th>
				<th style="text-align:center;">Tarifa Reaseguro</th>
				<th style="text-align:center;">Fondo</th>
				<th style="text-align:center;">Reaseguro</th>
				<th style="text-align:center;">Subtotal</th>
			</tr>
		</thead>
		<tfoot>
			<tr>
				<th>Total:</th>
				<td>{{ TotalTarifa }}</td>
				<td style="text-align:right;">{{ TotalTarifaFondo }}</td>
				<td style="text-align:right;">{{ TotalTarifaReaseguro }}</td>
				<th colspan="3" style="text-align:right;">
				{% if InformacionSolicitud.DeclaracionSolicitud == "ANUAL" %}
					Cuota Total: 
				{% else %}
					Prima en Deposito:
				{% endif %}
				<input type="text" id="Cuota" readonly value="{{ CuotaNeta }}" style="text-align:right;"></th>			
			</tr>
		</tfoot>
		<tbody>
			{% for cobertura in Coberturas %}
				<tr>
					<td style="display:none;">{{ cobertura.IdCobertura }}</td>
					<td>{{ cobertura.Descripcion }}</td>
					<td>{{ cobertura.Tarifa }}</td>
					<td style="text-align:right;">{{ cobertura.TarifaFondo }}</td>
					<td style="text-align:right;">{{ cobertura.TarifaReaseguro }}</td>
					<td style="display:none;">{{ cobertura.FondoCuota }}</td>
					<td style="display:none;">{{ cobertura.ReaseguroCuota }}</td>					
					<td style="text-align:right;">{{ cobertura.Fondo }}</td>
					<td style="text-align:right;">{{ cobertura.Reaseguro }}</td>
					<td style="text-align:right;">{{ cobertura.SubTotal }}</td>
				</tr>
			{% endfor %}
		</tbody>
	</table>
	
	<hr />
	<div class="row">	
		<!-- Generación de botones del formulario -->
		<div class="control-group pull-right">
	  		<label class="control-label"></label>
	  		<div class="controls">
	  			{% if not InformacionConstancia.0.IdConstancia %}
	  				<button id="btnGuardarConstancia" name="btnGuardarConstancia" class="btn btn-success">Guardar</button>
	  			{% endif %}
	  			<button id="btnVistaPrevia" name="btnVistaPrevia" class="btn btn-success"><i class="icon-file icon-white"></i> Vista Previa</button>
	    		<a role="button" class="sort btn btn-warning" id="btnListadoConstancias" href="/ListadoConstancias/"><i class="icon-list icon-white"></i> Listado Constancias</a>
	    		{% if not InformacionConstancia.0.IdConstancia %}
	    			<button id="btnCancelarConstancia" name="btnCancelarConstancia" class="btn btn-danger">Cancelar</button>
	    		{% endif %}
	  		</div>
		</div> <!-- Fin generación de botones del formulario -->
	</div>	
</form>
{% endblock contenido %}

{% block scriptjs %}
	<script src="/static/js/Constancia.js"></script>
{% endblock scriptjs %}